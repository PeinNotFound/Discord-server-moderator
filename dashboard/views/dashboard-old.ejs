<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Dashboard - <%= user.username %></title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <script>
        tailwind.config = {
            daisyui: {
                themes: [{
                    dark: {
                        "primary": "#5865F2",
                        "secondary": "#57F287",
                        "accent": "#FEE75C",
                        "neutral": "#23272A",
                        "base-100": "#2C2F33",
                        "base-200": "#23272A",
                        "base-300": "#1E2124",
                        "info": "#3B82F6",
                        "success": "#22C55E",
                        "warning": "#F59E0B",
                        "error": "#EF4444"
                    }
                }]
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            display: flex;
            min-height: 100vh;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Server Sidebar Styles */
        .server-sidebar {
            width: 72px;
            background: rgba(32, 34, 37, 0.85);
            height: 100vh;
            position: fixed;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 12px;
            overflow-y: auto;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            animation: slideInLeft 0.3s ease-out;
            z-index: 100;
        }
        
        .server-item {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin-bottom: 8px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .server-item:hover {
            border-radius: 16px;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .server-item.active {
            border-radius: 16px;
            background: #5865F2;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(88, 101, 242, 0.3);
        }
        
        .server-icon {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .server-item .indicator {
            position: absolute;
            width: 8px;
            height: 40px;
            left: -16px;
            top: 4px;
            border-radius: 0 4px 4px 0;
            background: white;
            display: none;
            animation: pulse 2s infinite;
        }
        
        .server-item.active .indicator {
            display: block;
        }
        
        .divider {
            width: 32px;
            height: 2px;
            background: #36393f;
            margin: 8px 0;
            border-radius: 1px;
        }
        
        /* Main Sidebar Styles */
        .main-sidebar {
            width: 240px;
            background: rgba(35, 39, 42, 0.9);
            height: 100vh;
            position: fixed;
            left: 72px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: 3px 0 20px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            animation: slideInLeft 0.4s ease-out;
            z-index: 90;
        }
        
        .server-header {
            padding: 20px 16px 16px;
            border-bottom: 1px solid #202225;
            margin-bottom: 20px;
            animation: slideInUp 0.5s ease-out;
        }
        
        .server-header h3 {
            color: #fff;
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .nav-section {
            margin-bottom: 30px;
            animation: slideInUp 0.5s ease-out;
        }
        
        .nav-section h3 {
            color: #72767d;
            font-size: 0.8rem;
            text-transform: uppercase;
            padding: 0 16px 10px;
            border-bottom: 1px solid #202225;
            margin-bottom: 10px;
        }
        
        .nav-links {
            list-style: none;
        }
        
        .nav-links li {
            margin-bottom: 5px;
        }
        
        .nav-links a {
            display: block;
            padding: 10px 16px;
            color: #b9bbbe;
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.3s;
            border-radius: 0 8px 8px 0;
            margin-right: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: #5865F2;
            transform: scaleY(0);
            transition: transform 0.3s;
        }
        
        .nav-links a:hover {
            background: rgba(255,255,255,0.05);
            color: #fff;
            transform: translateX(5px);
        }
        
        .nav-links a:hover::before {
            transform: scaleY(1);
        }
        
        .nav-links a.active {
            background: rgba(88, 101, 242, 0.2);
            color: white;
        }
        
        .nav-links a.active::before {
            transform: scaleY(1);
        }
        
        .nav-links a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 312px;
            animation: slideInRight 0.5s ease-out;
        }
        
        .navbar {
            background: rgba(35, 39, 42, 0.95);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 15px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 80;
            backdrop-filter: blur(10px);
        }
        
        .navbar h1 {
            color: #fff;
            font-size: 1.5rem;
            background: linear-gradient(90deg, #5865F2, #7289da);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: slideInLeft 0.5s ease-out;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideInRight 0.5s ease-out;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #5865F2, #4752C4);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(88, 101, 242, 0.3);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255,255,255,0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(50, 50);
                opacity: 0;
            }
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(88, 101, 242, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(88, 101, 242, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ed4245, #c03537);
            box-shadow: 0 4px 10px rgba(237, 66, 69, 0.3);
        }
        
        .btn-danger:hover {
            box-shadow: 0 6px 15px rgba(237, 66, 69, 0.4);
        }
        
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(44, 47, 51, 0.7);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
            animation: slideInUp 0.5s ease-out;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.4);
        }
        
        .stat-card h3 {
            color: #b9bbbe;
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #72767d;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .config-section {
            background: rgba(44, 47, 51, 0.7);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.05);
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .config-section.active {
            display: block;
        }
        
        .config-section h2 {
            margin-bottom: 20px;
            color: #fff;
            font-size: 1.8rem;
            background: linear-gradient(90deg, #5865F2, #7289da);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #b9bbbe;
            font-weight: 500;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            background: rgba(32, 34, 37, 0.7);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: #dcddde;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #5865F2;
            box-shadow: 0 0 0 3px rgba(88, 101, 242, 0.3);
        }
        
        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #3ba55d;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.9); }
        }
        
        .update-success {
            background: rgba(59, 165, 93, 0.2);
            color: #3ba55d;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
            border: 1px solid #3ba55d;
            animation: fadeIn 0.3s ease-in;
        }
        
        /* Tab Navigation */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
        }
        
        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            color: #b9bbbe;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
            border-radius: 6px 6px 0 0;
        }
        
        .tab-btn:hover {
            color: #fff;
            background: rgba(255,255,255,0.05);
        }
        
        .tab-btn.active {
            color: #5865F2;
            border-bottom-color: #5865F2;
            background: rgba(88, 101, 242, 0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Filter Buttons */
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 20px;
            background: rgba(32, 34, 37, 0.7);
            color: #b9bbbe;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .filter-btn:hover {
            background: rgba(54, 57, 63, 0.7);
            color: #fff;
            transform: translateY(-2px);
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, #5865F2, #4752C4);
            color: white;
            border-color: #5865F2;
            box-shadow: 0 4px 10px rgba(88, 101, 242, 0.3);
        }
        
        /* Actions List */
        .actions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .action-item {
            background: rgba(32, 34, 37, 0.7);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #5865F2;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .action-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .action-item.ban {
            border-left-color: #ed4245;
        }
        
        .action-item.mute {
            border-left-color: #ffa500;
        }
        
        .action-item.warning {
            border-left-color: #fee75c;
        }
        
        .action-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #5865F2;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .action-details {
            flex: 1;
        }
        
        .action-user {
            font-weight: bold;
            color: #fff;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .action-type {
            color: #72767d;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        
        .action-reason {
            color: #b9bbbe;
            font-size: 0.9rem;
        }
        
        .action-time {
            color: #72767d;
            font-size: 0.85rem;
            white-space: nowrap;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #72767d;
        }
        
        /* Moderate Form */
        .moderate-form {
            max-width: 600px;
            margin: 0 auto;
        }
        
        textarea {
            width: 100%;
            padding: 12px;
            background: rgba(32, 34, 37, 0.7);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: #dcddde;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            transition: all 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #5865F2;
            box-shadow: 0 0 0 3px rgba(88, 101, 242, 0.3);
        }
        
        .moderate-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }
        
        .btn-mod {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        
        .btn-mod:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.4);
        }
        
        .btn-mod:active {
            transform: translateY(-1px);
        }
        
        .btn-mod.warn {
            background: linear-gradient(135deg, #ffa500, #e69500);
            color: #000;
        }
        
        .btn-mod.mute {
            background: linear-gradient(135deg, #7289da, #5b6eae);
            color: white;
        }
        
        .btn-mod.kick {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
        }
        
        .btn-mod.ban {
            background: linear-gradient(135deg, #ed4245, #c03537);
            color: white;
        }
        
        .mod-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .mod-result.success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid #2ecc71;
        }
        
        .mod-result.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        /* Config Sections */
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .config-card {
            background: rgba(32, 34, 37, 0.7);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #5865F2;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s;
        }
        
        .config-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .config-card h3 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .config-card .form-group {
            margin-bottom: 15px;
        }
        
        .config-card .form-group:last-child {
            margin-bottom: 0;
        }
        
        /* Verification Rooms */
        .verification-rooms {
            background: rgba(32, 34, 37, 0.5);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .room-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .room-input input {
            flex: 1;
        }
        
        .room-input button {
            background: linear-gradient(135deg, #ed4245, #c03537);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(237, 66, 69, 0.3);
        }
        
        .room-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(237, 66, 69, 0.4);
        }
        
        .add-room-btn {
            background: linear-gradient(135deg, #3ba55d, #2f854a);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.9rem;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(59, 165, 93, 0.3);
        }
        
        .add-room-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(59, 165, 93, 0.4);
        }
        
        /* Welcome/Leave Messages */
        .message-preview {
            background: rgba(32, 34, 37, 0.5);
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #b9bbbe;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .preview-title {
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <!-- Server Sidebar (Left) -->
    <div class="server-sidebar">
        <!-- User Profile -->
        <div class="server-item">
            <img src="https://cdn.discordapp.com/avatars/<%= user.id %>/<%= user.avatar %>.png" 
                 alt="<%= user.username %>" 
                 class="server-icon"
                 onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'">
            <div class="indicator"></div>
        </div>
        
        <div class="divider"></div>
        
        <!-- Server Icons -->
        <% if (user.guilds && user.guilds.length > 0) { %>
            <% user.guilds.forEach(function(guild, index) { %>
                <% if (guild.permissions & 0x8) { // Check for Administrator permission %>
                    <div class="server-item" onclick="selectServer('<%= guild.id %>')" data-server-id="<%= guild.id %>">
                        <% if (guild.icon) { %>
                            <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png" 
                                 alt="<%= guild.name %>" 
                                 class="server-icon">
                        <% } else { %>
                            <div style="width:100%;height:100%;background:#5865F2;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;color:white;">
                                <%= guild.name.charAt(0).toUpperCase() %>
                            </div>
                        <% } %>
                        <div class="indicator"></div>
                    </div>
                <% } %>
            <% }); %>
        <% } %>
    </div>
    
    <!-- Main Sidebar (Middle) -->
    <div class="main-sidebar">
        <div class="server-header">
            <h3 id="currentServerName">Select a Server</h3>
        </div>
        
        <div class="nav-section">
            <h3>Dashboard</h3>
            <ul class="nav-links">
                <li><a href="#" class="active" onclick="showSection('overview')"><i>üìä</i> Overview</a></li>
                <li><a href="#" onclick="showSection('modactions')"><i>üìù</i> Mod Actions</a></li>
                <li><a href="#" onclick="showSection('moderate')"><i>üõ°Ô∏è</i> Moderate</a></li>
            </ul>
        </div>
        
        <div class="nav-section">
            <h3>Configuration</h3>
            <ul class="nav-links">
                <li><a href="#" onclick="showSection('main-config')"><i>‚öôÔ∏è</i> Main Config</a></li>
                <li><a href="#" onclick="showSection('messages-config')"><i>üí¨</i> Messages</a></li>
                <li><a href="#" onclick="showSection('verification-config')"><i>‚úÖ</i> Verification</a></li>
                <li><a href="#" onclick="showSection('advanced-config')"><i>üîß</i> Advanced</a></li>
            </ul>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <nav class="navbar">
            <h1>ü§ñ Bot Dashboard</h1>
            <div class="user-info">
                <span><span class="live-indicator"></span>Live Updates</span>
                <img src="https://cdn.discordapp.com/avatars/<%= user.id %>/<%= user.avatar %>.png" 
                     alt="<%= user.username %>" 
                     class="user-avatar">
                <span><%= user.username %></span>
                <a href="/logout" class="btn btn-danger">Logout</a>
            </div>
        </nav>
        
        <div class="container">
            <!-- Overview Section -->
            <div id="overview-section" class="config-section active">
                <h2>üìä Dashboard Overview</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>‚ö†Ô∏è Warned Users</h3>
                        <div class="stat-value" id="warnedCount"><%= stats.warnedUsers %></div>
                        <div class="stat-label">Total users with warnings</div>
                    </div>
                    
                    <div class="stat-card">
                        <h3>üîí Jailed Users</h3>
                        <div class="stat-value" id="jailedCount"><%= stats.jailedUsers %></div>
                        <div class="stat-label">Currently jailed</div>
                    </div>
                    
                    <div class="stat-card">
                        <h3>üìä Total Actions</h3>
                        <div class="stat-value"><%= stats.warnedUsers + stats.jailedUsers %></div>
                        <div class="stat-label">Combined moderation actions</div>
                    </div>
                </div>
            </div>
            
            <!-- Mod Actions Section -->
            <div id="modactions-section" class="config-section">
                <h2>üìù Mod Actions</h2>
                <p style="color: #72767d; margin-bottom: 20px;">View all moderation actions taken on the server</p>
                
                <!-- Filter Buttons -->
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterActions('all')">All</button>
                    <button class="filter-btn" onclick="filterActions('bans')">Bans</button>
                    <button class="filter-btn" onclick="filterActions('mutes')">Mutes</button>
                    <button class="filter-btn" onclick="filterActions('warnings')">Warnings</button>
                </div>
                
                <!-- Actions List -->
                <div class="actions-list" id="actionsList">
                    <div class="loading">Loading actions...</div>
                </div>
            </div>
            
            <!-- Moderate Section -->
            <div id="moderate-section" class="config-section">
                <h2>üõ°Ô∏è Moderate Users</h2>
                <p style="color: #72767d; margin-bottom: 20px;">Take moderation actions directly from the dashboard</p>
                
                <div class="moderate-form">
                    <div class="form-group">
                        <label>User ID or @mention</label>
                        <input type="text" id="targetUser" placeholder="123456789012345678 or @username">
                    </div>
                    
                    <div class="form-group">
                        <label>Reason</label>
                        <textarea id="modReason" placeholder="Enter reason for moderation action" rows="3"></textarea>
                    </div>
                    
                    <div class="moderate-actions">
                        <button class="btn-mod warn" onclick="moderateUser('warn')">‚ö†Ô∏è Warn</button>
                        <button class="btn-mod mute" onclick="moderateUser('mute')">üîá Mute</button>
                        <button class="btn-mod kick" onclick="moderateUser('kick')">üë¢ Kick</button>
                        <button class="btn-mod ban" onclick="moderateUser('ban')">üö´ Ban</button>
                    </div>
                    
                    <div class="mod-result" id="modResult"></div>
                </div>
            </div>
            
            <!-- Main Configuration Section -->
            <div id="main-config-section" class="config-section">
                <h2>‚öôÔ∏è Main Configuration</h2>
                <p style="color: #72767d; margin-bottom: 20px;">
                    Changes will apply instantly without restarting the bot
                </p>
                
                <div class="config-grid">
                    <div class="config-card">
                        <h3>Bot Settings</h3>
                        <div class="form-group">
                            <label>Command Prefix</label>
                            <input type="text" id="PREFIX" value="<%= config.main.PREFIX || '!' %>" placeholder="!">
                        </div>
                        
                        <div class="form-group">
                            <label>Moderator Role IDs (comma-separated)</label>
                            <input type="text" id="MODERATOR_ROLES" value="<%= config.main.MODERATOR_ROLES || '' %>" 
                                   placeholder="123456789,987654321">
                        </div>
                        
                        <div class="form-group">
                            <label>Admin Role IDs (comma-separated)</label>
                            <input type="text" id="ADMIN_ROLES" value="<%= config.main.ADMIN_ROLES || '' %>" 
                                   placeholder="123456789,987654321">
                        </div>
                        
                        <div class="form-group">
                            <label>Voice Moderator Role IDs (comma-separated)</label>
                            <input type="text" id="VOICE_MODERATOR_ROLES" value="<%= config.main.VOICE_MODERATOR_ROLES || '' %>" 
                                   placeholder="123456789,987654321">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Role IDs</h3>
                        <div class="form-group">
                            <label>Warn Role ID</label>
                            <input type="text" id="WARN_ROLE_ID" value="<%= config.main.WARN_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Jail Role ID</label>
                            <input type="text" id="JAIL_ROLE_ID" value="<%= config.main.JAIL_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Muted Role ID</label>
                            <input type="text" id="MUTED_ROLE_ID" value="<%= config.main.MUTED_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Log Channels</h3>
                        <div class="form-group">
                            <label>Jail Log Channel ID</label>
                            <input type="text" id="JAIL_LOG_CHANNEL_ID" value="<%= config.main.JAIL_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Warn Log Channel ID</label>
                            <input type="text" id="WARN_LOG_CHANNEL_ID" value="<%= config.main.WARN_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Mute Log Channel ID</label>
                            <input type="text" id="MUTE_LOG_CHANNEL_ID" value="<%= config.main.MUTE_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Ban Log Channel ID</label>
                            <input type="text" id="BAN_LOG_CHANNEL_ID" value="<%= config.main.BAN_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Kick Log Channel ID</label>
                            <input type="text" id="KICK_LOG_CHANNEL_ID" value="<%= config.main.KICK_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="saveMainConfig()">Save Configuration</button>
                <div class="update-success" id="mainConfigSuccess">
                    ‚úÖ Configuration updated successfully!
                </div>
            </div>
            
            <!-- Messages Configuration Section -->
            <div id="messages-config-section" class="config-section">
                <h2>üí¨ Welcome & Leave Messages</h2>
                <p style="color: #72767d; margin-bottom: 20px;">
                    Customize messages sent when users join or leave the server
                </p>
                
                <div class="config-grid">
                    <div class="config-card">
                        <h3>Welcome Message</h3>
                        <div class="form-group">
                            <label>Message Template</label>
                            <textarea id="WELCOME_MESSAGE" rows="3" placeholder="Welcome {user} to {server}! Enjoy your stay!"><%= config.main.WELCOME_MESSAGE || 'Welcome {user} to {server}! Enjoy your stay!' %></textarea>
                            <div class="message-preview">
                                <div class="preview-title">Preview:</div>
                                <div id="welcomeMessagePreview">Welcome User to Server! Enjoy your stay!</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Welcome Log Channel ID</label>
                            <input type="text" id="MEMBER_JOIN_LOG_CHANNEL_ID" value="<%= config.main.MEMBER_JOIN_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Leave Message</h3>
                        <div class="form-group">
                            <label>Message Template</label>
                            <textarea id="LEAVE_MESSAGE" rows="3" placeholder="Goodbye {user}! Thanks for being part of {server}."><%= config.main.LEAVE_MESSAGE || 'Goodbye {user}! Thanks for being part of {server}.' %></textarea>
                            <div class="message-preview">
                                <div class="preview-title">Preview:</div>
                                <div id="leaveMessagePreview">Goodbye User! Thanks for being part of Server.</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Leave Log Channel ID</label>
                            <input type="text" id="MEMBER_LEAVE_LOG_CHANNEL_ID" value="<%= config.main.MEMBER_LEAVE_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="saveMessagesConfig()">Save Messages Config</button>
                <div class="update-success" id="messagesConfigSuccess">
                    ‚úÖ Messages configuration updated successfully!
                </div>
            </div>
            
            <!-- Verification Configuration Section -->
            <div id="verification-config-section" class="config-section">
                <h2>‚úÖ Verification Configuration</h2>
                <p style="color: #72767d; margin-bottom: 20px;">
                    Configure the verification system for new members
                </p>
                
                <div class="config-grid">
                    <div class="config-card">
                        <h3>Verification Roles</h3>
                        <div class="form-group">
                            <label>Verified Role ID (Male/Neutral)</label>
                            <input type="text" id="VERIFIED_ROLE_ID" value="<%= config.verification.VERIFIED_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Verified Female Role ID</label>
                            <input type="text" id="VERIFIED_FEMALE_ROLE_ID" value="<%= config.verification.VERIFIED_FEMALE_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Unverified Role ID</label>
                            <input type="text" id="UNVERIFIED_ROLE_ID" value="<%= config.verification.UNVERIFIED_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Verificator Role ID</label>
                            <input type="text" id="VERIFICATOR_ROLE_ID" value="<%= config.verification.VERIFICATOR_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Verification Channels</h3>
                        <div class="form-group">
                            <label>Verification Command Channel ID</label>
                            <input type="text" id="VERIFICATION_CMD_CHANNEL_ID" value="<%= config.verification.VERIFICATION_CMD_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Verification Chat Channel ID</label>
                            <input type="text" id="VERIFICATION_CHAT_CHANNEL_ID" value="<%= config.verification.VERIFICATION_CHAT_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Verification Log Channel ID</label>
                            <input type="text" id="VERIFICATION_LOG_CHANNEL_ID" value="<%= config.verification.VERIFICATION_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Verification Rooms</h3>
                        <div class="verification-rooms">
                            <div id="verificationRoomsContainer">
                                <% if (config.verification.VERIFICATION_ROOMS && config.verification.VERIFICATION_ROOMS.length > 0) { %>
                                    <% config.verification.VERIFICATION_ROOMS.forEach(function(roomId, index) { %>
                                        <div class="room-input" data-index="<%= index %>">
                                            <input type="text" class="verification-room-input" value="<%= roomId %>" placeholder="voice_channel_id_here">
                                            <button type="button" class="remove-room-btn" data-index="<%= index %>">‚úï</button>
                                        </div>
                                    <% }); %>
                                <% } else { %>
                                    <div class="room-input" data-index="0">
                                        <input type="text" class="verification-room-input" placeholder="voice_channel_id_here">
                                        <button type="button" class="remove-room-btn" data-index="0">‚úï</button>
                                    </div>
                                <% } %>
                            </div>
                            <button type="button" class="add-room-btn" onclick="addVerificationRoom()">+ Add Room</button>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label>Ping Unverified Interval (ms)</label>
                            <input type="number" id="PING_UNVERIFIED_INTERVAL" value="<%= config.verification.PING_UNVERIFIED_INTERVAL || 3600000 %>" 
                                   placeholder="3600000">
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="saveVerificationConfig()">Save Verification Config</button>
                <div class="update-success" id="verificationConfigSuccess">
                    ‚úÖ Verification configuration updated successfully!
                </div>
            </div>
            
            <!-- Advanced Configuration Section -->
            <div id="advanced-config-section" class="config-section">
                <h2>üîß Advanced Configuration</h2>
                <p style="color: #72767d; margin-bottom: 20px;">
                    Advanced settings for the bot
                </p>
                
                <div class="config-grid">
                    <div class="config-card">
                        <h3>Rank System Roles</h3>
                        <div class="form-group">
                            <label>Trial Staff Role ID</label>
                            <input type="text" id="TRIAL_STAFF_ROLE_ID" value="<%= config.main.TRIAL_STAFF_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Staff Role ID</label>
                            <input type="text" id="STAFF_ROLE_ID" value="<%= config.main.STAFF_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Moderator Role ID</label>
                            <input type="text" id="MODERATOR_ROLE_ID" value="<%= config.main.MODERATOR_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Head Moderator Role ID</label>
                            <input type="text" id="HEAD_MODERATOR_ROLE_ID" value="<%= config.main.HEAD_MODERATOR_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Advanced Role IDs</h3>
                        <div class="form-group">
                            <label>Manager Role ID</label>
                            <input type="text" id="MANAGER_ROLE_ID" value="<%= config.main.MANAGER_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Head Manager Role ID</label>
                            <input type="text" id="HEAD_MANAGER_ROLE_ID" value="<%= config.main.HEAD_MANAGER_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Administrator Role ID</label>
                            <input type="text" id="ADMINISTRATOR_ROLE_ID" value="<%= config.main.ADMINISTRATOR_ROLE_ID || '' %>" 
                                   placeholder="role_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Rank Admin Role IDs (comma-separated)</label>
                            <input type="text" id="RANK_ADMIN_ROLES" value="<%= config.main.RANK_ADMIN_ROLES || '' %>" 
                                   placeholder="123456789,987654321">
                        </div>
                    </div>
                    
                    <div class="config-card">
                        <h3>Advanced Settings</h3>
                        <div class="form-group">
                            <label>Temporary Rooms Category ID</label>
                            <input type="text" id="TEMP_ROOMS_CATEGORY_ID" value="<%= config.main.TEMP_ROOMS_CATEGORY_ID || '' %>" 
                                   placeholder="category_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Rank Log Channel ID</label>
                            <input type="text" id="RANK_LOG_CHANNEL_ID" value="<%= config.main.RANK_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Unban Log Channel ID</label>
                            <input type="text" id="UNBAN_LOG_CHANNEL_ID" value="<%= config.main.UNBAN_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Nickname Log Channel ID</label>
                            <input type="text" id="NICKNAME_LOG_CHANNEL_ID" value="<%= config.main.NICKNAME_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Voice Mod Log Channel ID</label>
                            <input type="text" id="VOICE_MOD_LOG_CHANNEL_ID" value="<%= config.main.VOICE_MOD_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                        
                        <div class="form-group">
                            <label>Move Log Channel ID</label>
                            <input type="text" id="MOVE_LOG_CHANNEL_ID" value="<%= config.main.MOVE_LOG_CHANNEL_ID || '' %>" 
                                   placeholder="channel_id_here">
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="saveAdvancedConfig()">Save Advanced Config</button>
                <div class="update-success" id="advancedConfigSuccess">
                    ‚úÖ Advanced configuration updated successfully!
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Connect to WebSocket
        const socket = io();
        
        // Listen for stats updates
        socket.on('statsUpdate', (data) => {
            document.getElementById('warnedCount').textContent = data.warnedUsers;
            document.getElementById('jailedCount').textContent = data.jailedUsers;
        });
        
        // Server selection
        function selectServer(serverId) {
            // Remove active class from all server items
            document.querySelectorAll('.server-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to selected server
            const selectedItem = document.querySelector(`.server-item[data-server-id="${serverId}"]`);
            if (selectedItem) {
                selectedItem.classList.add('active');
            }
            
            // Update current server name (in a real implementation, you would fetch server details)
            const serverName = selectedItem ? selectedItem.title : 'Unknown Server';
            document.getElementById('currentServerName').textContent = serverName;
            
            // In a real implementation, you would load server-specific data here
            console.log('Selected server:', serverId);
        }
        
        // Section navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.config-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.add('active');
            
            // Add active class to clicked nav link
            event.target.classList.add('active');
        }
        
        // Save main configuration
        async function saveMainConfig() {
            const configFields = [
                'PREFIX', 'MODERATOR_ROLES', 'ADMIN_ROLES', 'VOICE_MODERATOR_ROLES',
                'WARN_ROLE_ID', 'JAIL_ROLE_ID', 'MUTED_ROLE_ID',
                'JAIL_LOG_CHANNEL_ID', 'WARN_LOG_CHANNEL_ID', 'MUTE_LOG_CHANNEL_ID',
                'BAN_LOG_CHANNEL_ID', 'KICK_LOG_CHANNEL_ID'
            ];
            
            const configData = {};
            configFields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    configData[field] = element.value;
                }
            });
            
            try {
                const response = await fetch('/api/config/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        type: 'main',
                        config: configData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const msg = document.getElementById('mainConfigSuccess');
                    msg.style.display = 'block';
                    setTimeout(() => {
                        msg.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('Failed to save config:', error);
                alert('Failed to save configuration');
            }
        }
        
        // Save messages configuration
        async function saveMessagesConfig() {
            const configFields = [
                'WELCOME_MESSAGE', 'LEAVE_MESSAGE',
                'MEMBER_JOIN_LOG_CHANNEL_ID', 'MEMBER_LEAVE_LOG_CHANNEL_ID'
            ];
            
            const configData = {};
            configFields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    configData[field] = element.value;
                }
            });
            
            try {
                const response = await fetch('/api/config/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        type: 'main',
                        config: configData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const msg = document.getElementById('messagesConfigSuccess');
                    msg.style.display = 'block';
                    setTimeout(() => {
                        msg.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('Failed to save config:', error);
                alert('Failed to save configuration');
            }
        }
        
        // Save verification configuration
        async function saveVerificationConfig() {
            const configFields = [
                'VERIFIED_ROLE_ID', 'VERIFIED_FEMALE_ROLE_ID', 'UNVERIFIED_ROLE_ID',
                'VERIFICATOR_ROLE_ID', 'VERIFICATION_CMD_CHANNEL_ID',
                'VERIFICATION_CHAT_CHANNEL_ID', 'VERIFICATION_LOG_CHANNEL_ID',
                'PING_UNVERIFIED_INTERVAL'
            ];
            
            const configData = {};
            configFields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    configData[field] = element.value;
                }
            });
            
            // Get verification rooms
            const roomInputs = document.querySelectorAll('.verification-room-input');
            const rooms = Array.from(roomInputs).map(input => input.value).filter(value => value.trim() !== '');
            configData.VERIFICATION_ROOMS = rooms;
            
            try {
                const response = await fetch('/api/config/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        type: 'verification',
                        config: configData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const msg = document.getElementById('verificationConfigSuccess');
                    msg.style.display = 'block';
                    setTimeout(() => {
                        msg.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('Failed to save config:', error);
                alert('Failed to save configuration');
            }
        }
        
        // Save advanced configuration
        async function saveAdvancedConfig() {
            const configFields = [
                'TRIAL_STAFF_ROLE_ID', 'STAFF_ROLE_ID', 'MODERATOR_ROLE_ID',
                'HEAD_MODERATOR_ROLE_ID', 'MANAGER_ROLE_ID', 'HEAD_MANAGER_ROLE_ID',
                'ADMINISTRATOR_ROLE_ID', 'RANK_ADMIN_ROLES', 'TEMP_ROOMS_CATEGORY_ID',
                'RANK_LOG_CHANNEL_ID', 'UNBAN_LOG_CHANNEL_ID', 'NICKNAME_LOG_CHANNEL_ID',
                'VOICE_MOD_LOG_CHANNEL_ID', 'MOVE_LOG_CHANNEL_ID'
            ];
            
            const configData = {};
            configFields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    configData[field] = element.value;
                }
            });
            
            try {
                const response = await fetch('/api/config/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        type: 'main',
                        config: configData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const msg = document.getElementById('advancedConfigSuccess');
                    msg.style.display = 'block';
                    setTimeout(() => {
                        msg.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('Failed to save config:', error);
                alert('Failed to save configuration');
            }
        }
        
        // Verification rooms management
        function addVerificationRoom() {
            const container = document.getElementById('verificationRoomsContainer');
            const roomCount = container.children.length;
            
            const roomDiv = document.createElement('div');
            roomDiv.className = 'room-input';
            roomDiv.setAttribute('data-index', roomCount);
            roomDiv.innerHTML = `
                <input type="text" class="verification-room-input" placeholder="voice_channel_id_here">
                <button type="button" class="remove-room-btn" data-index="${roomCount}">‚úï</button>
            `;
            
            container.appendChild(roomDiv);
        }
        
        function removeVerificationRoom(index) {
            const roomDiv = document.querySelector(`.room-input[data-index="${index}"]`);
            if (roomDiv) {
                roomDiv.remove();
            }
        }
        
        // Event delegation for remove room buttons
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('remove-room-btn')) {
                const index = event.target.getAttribute('data-index');
                removeVerificationRoom(index);
            }
        });
        
        // Message preview functionality
        document.getElementById('WELCOME_MESSAGE').addEventListener('input', function() {
            const message = this.value || 'Welcome {user} to {server}! Enjoy your stay!';
            const preview = message
                .replace(/{user}/g, 'User')
                .replace(/{server}/g, 'Server');
            document.getElementById('welcomeMessagePreview').textContent = preview;
        });
        
        document.getElementById('LEAVE_MESSAGE').addEventListener('input', function() {
            const message = this.value || 'Goodbye {user}! Thanks for being part of {server}.';
            const preview = message
                .replace(/{user}/g, 'User')
                .replace(/{server}/g, 'Server');
            document.getElementById('leaveMessagePreview').textContent = preview;
        });
        
        // Initialize message previews
        document.getElementById('WELCOME_MESSAGE').dispatchEvent(new Event('input'));
        document.getElementById('LEAVE_MESSAGE').dispatchEvent(new Event('input'));
        
        console.log('üì± Dashboard connected and ready!');
        
        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Activate button
            event.target.classList.add('active');
            
            // Load mod actions if switching to that tab
            if (tabName === 'modactions') {
                loadModActions();
            }
        }
        
        // Load moderation actions
        async function loadModActions() {
            try {
                const response = await fetch('/api/modactions');
                const data = await response.json();
                
                displayActions(data.actions);
            } catch (error) {
                console.error('Failed to load mod actions:', error);
                document.getElementById('actionsList').innerHTML = '<div class="loading">‚ùå Failed to load actions</div>';
            }
        }
        
        // Display actions
        function displayActions(actions) {
            const container = document.getElementById('actionsList');
            
            if (!actions || actions.length === 0) {
                container.innerHTML = '<div class="loading">No moderation actions found</div>';
                return;
            }
            
            container.innerHTML = actions.map(action => `
                <div class="action-item ${action.action.toLowerCase()}" data-type="${action.action.toLowerCase()}">
                    <div class="action-avatar">${getActionEmoji(action.action)}</div>
                    <div class="action-details">
                        <div class="action-user">${action.target.username}#${action.target.discriminator}</div>
                        <div class="action-type">${action.action} by ${action.moderator.username}#${action.moderator.discriminator}</div>
                        <div class="action-reason">Reason: ${action.reason || 'No reason provided'}</div>
                    </div>
                    <div class="action-time">${formatTime(action.timestamp)}</div>
                </div>
            `).join('');
        }
        
        // Filter actions
        function filterActions(type) {
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter items
            const items = document.querySelectorAll('.action-item');
            items.forEach(item => {
                if (type === 'all') {
                    item.style.display = 'flex';
                } else {
                    item.style.display = item.dataset.type === type ? 'flex' : 'none';
                }
            });
        }
        
        // Helper functions
        function getActionEmoji(type) {
            const emojis = {
                'ban': 'üî®',
                'kick': 'üë¢',
                'mute': 'üîá',
                'warning': '‚ö†Ô∏è',
                'jail': 'üîí',
                'unmute': 'üîä',
                'unwarn': '‚úÖ'
            };
            return emojis[type.toLowerCase()] || 'üõ°Ô∏è';
        }
        
        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            return `${days}d ago`;
        }
        
        // Moderate user
        async function moderateUser(action) {
            const userId = document.getElementById('targetUser').value.trim();
            const reason = document.getElementById('modReason').value.trim() || 'No reason provided';
            const resultDiv = document.getElementById('modResult');
            
            if (!userId) {
                showResult('Please enter a user ID or mention', 'error');
                return;
            }
            
            try {
                const response = await fetch(`/api/moderate/${action}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        userId: userId,
                        reason: reason
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showResult(`${action.charAt(0).toUpperCase() + action.slice(1)} issued successfully!`, 'success');
                    document.getElementById('targetUser').value = '';
                    document.getElementById('modReason').value = '';
                } else {
                    showResult(data.message || 'Failed to issue moderation action', 'error');
                }
            } catch (error) {
                showResult('Network error occurred', 'error');
            }
        }
        
        // Show result message
        function showResult(message, type) {
            const resultDiv = document.getElementById('modResult');
            resultDiv.textContent = message;
            resultDiv.className = `mod-result ${type}`;
            resultDiv.style.display = 'block';
            
            setTimeout(() => {
                resultDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>